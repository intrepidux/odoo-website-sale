<?xml version="1.0" encoding="utf-8"?>
<openerp>
  <data>
    <template id="home_page_order" inherit_id="website_sale_home.home_page" name="Home Page Order">
      <xpath expr="//ul[@id='home_tab_nav']" position="inside">
        <li t-att-class="'active' if tab == 'orders' else ''">
          <a href="#orders" data-toggle="tab" class="list-group-item text-center">
            <h4>
              <i class="fa fa-dollar" />
            </h4>
            <h4 class="hidden-xs">Orders</h4>
          </a>
        </li>
      </xpath>
      <xpath expr="//div[@id='home_tab_content']" position="inside">
        <div id="orders" t-att-class="'tab-pane %s' %('active' if tab == 'orders' else '')">
          <div id="orders_div">
            <div class="row" style="width: 100%; padding-left: 15px;">
              <form t-att-action="'/home/%s/order_search#orders' % (home_user.id)" method="post" class="pagination form-inline col-md-3">
                <div class="container">
                  <div class="input-group">
                    <input name="order_search" class="search-query form-control" placeholder="Search..." type="text" t-att-value="order_search" />
                    <span class="input-group-btn">
                      <button type="submit" class="btn btn-default">
                        <i class="fa fa-search" />
                      </button>
                    </span>
                  </div>
                </div>
              </form>
            </div>
            <table class="table table-striped">
              <thead>
                <tr>
                  <td>
                    <b>
                      Order number
                    </b>
                  </td>
                  <td>
                    <b>
                      Date
                    </b>
                  </td>
                  <td>
                    <b>
                      Payment Method
                    </b>
                  </td>
                  <td>
                    <b>
                      Delivery Method
                    </b>
                  </td>
                  <td>
                    <b>
                      State
                    </b>
                  </td>
                  <td>
                    <b>
                      Total
                    </b>
                  </td>
                </tr>
              </thead>
              <tbody>
                <tr t-foreach="website.sale_home_order_get(home_user,order_search or None)" t-as="order">
                  <td>
                      <a t-att-href="'/home/%s/order/%s' %(home_user.id, order.id)">
                        <t t-esc="order.name" />
                      </a>
                  </td>
                  <td>
                      <t t-esc="order.date_order[:10]" />
                  </td>
                  <td>
                      <t t-esc="order.payment_acquirer_id.name" />
                  </td>
                  <td>
                      <t t-esc="order.carrier_id.name" />
                  </td>
                  <td>
                    <t t-esc="order.state" />
                  </td>
                  <td>
                      <t t-esc="order.amount_total" />
                      <t t-esc="order.currency_id.name" />
                  </td>
<!--
                  <td>
                      <a t-att-href="website.sale_home_order_get_picking(order)[0]" target="_blank">Picking <t t-esc="website.sale_home_order_get_picking(order)[1]"/> <t t-esc="website.sale_home_order_get_picking(order)[2]"/></a>
                      <a t-att-href="website.sale_home_order_get_invoice(order)[0]" target="_blank">Invoice <t t-esc="website.sale_home_order_get_invoice(order)[1]"/> <t t-esc="website.sale_home_order_get_invoice(order)[2]"/></a>
                  </td>
-->
                </tr>
              </tbody>
            </table>
          </div>
        </div>
      </xpath>
    </template>
    <template id="page_order" name="Page Order">
      <t t-call="website.layout">
        <div id="wrap" class="oe_structure oe_empty">
          <section>
            <div class="container order_detail mt32 mb32" t-if="order">
              <div class="row">
                <form t-att-action="'/home/%s' %home_user.id" method="post">
                  <input type="hidden" name="tab" value="orders"/>
                  <button type="submit" class="btn btn-default" style="margin-left: 15px;">
                    <i class="fa fa-angle-left" />
                    <t t-set="tab" t-value="'orders'"/>
                    Back To My Account
                  </button>
                </form>
                <div>
                  <div class="col-xs-12 col-md-5 col-lg-5">
                    <h3>
                      <t t-esc="order.name" /> - <t t-esc="order.order_state_frontend()"/>
                    </h3>
                  </div>
                  <div class="order-detail-header-link-box col-xs-12 col-md-7 col-lg-7">
                    <a t-att-href="'/report/pdf/sale.report_saleorder/%s' %order.id" target="_blank"><i class="fa fa-download"/>&amp;nbsp;Download order</a>
                    <t t-foreach="order.invoice_ids" t-as="invoice">
                      <a t-att-href="'/report/pdf/account.report_invoice/%s' %invoice.id" target="_blank"><i class="fa fa-download"/>&amp;nbsp;Download invoice <t t-esc="invoice.number"/></a>
                    </t>
                    <t t-foreach="order.picking_ids" t-as="picking">
                      <a t-att-href="'/report/pdf/stock_delivery_slip.stock_delivery_slip/%s' %picking.id" target="_blank"><i class="fa fa-download"/>&amp;nbsp;Download picking<t t-esc="picking.name"/></a>
                    </t>
                    <a t-att-href="'/home/%s/order/%s/copy' % (home_user.id, order.id)" target="_blank"><i class="fa fa-plus"/>&amp;nbsp;Copy to cart</a>
                  </div>
                </div>
              </div>
              <div class="row">
                  <div class="col-md-4">
                    <div class="container">
                      <div class="row">
                        <div class="col-md-12">
                          <h4>Order information</h4>
                        </div>
                      </div>
                      <div class="row">
                        <div class="col-md-6">
                          <strong>Order number</strong>
                        </div>
                        <div class="col-md-6">
                          <t t-esc="order.name"/>
                        </div>
                        </div>
                        <div class="row">
                          <div class="col-md-6">
                            <strong>Order date</strong>
                          </div>
                          <div class="col-md-6">
                            <t t-esc="order.date_order"/>
                          </div>
                        </div>
                        <div class="row">
                          <div class="col-md-6">
                            <strong>Payment method</strong>
                          </div>
                          <div class="col-md-6">
                            <t t-esc="order.payment_acquirer_id.name"/>
                          </div>
                        </div>
                        <div class="row">
                          <div class="col-md-6">
                            <strong>Delivery method</strong>
                          </div>
                          <div class="col-md-6">
                            <t t-esc="order.carrier_id.name"/>
                          </div>
                        </div>
                      </div>
                  </div>
                  <div class="col-md-4">
                    <h4>Delivery Address</h4>
                    <div t-field="order.partner_shipping_id" t-field-options='{
                      "widget": "contact",
                      "fields": ["name", "address", "phone", "mobile", "fax", "email"]}'/>
                  </div>
                  <div class="col-md-4">
                    <h4>Invoice Address</h4>
                    <div t-field="order.partner_invoice_id" t-field-options='{
                      "widget": "contact",
                      "fields": ["name", "address", "phone", "mobile", "fax", "email"]}'/>
                  </div>
              </div>
              <div id="order_buttons" class="mt32 mb32"/>
            </div>
            <div class="container order_detail mt32 mb32">
              <div class="row">
                  <div class="col-lg-12 col-md-12 col-sm-12">
                    <h4 class="text-center">
                      <strong>Products</strong>
                    </h4>
                    <table class="table">
                      <thead>
                        <th>Quantity</th>
                        <th>Name</th>
                        <th class="hidden-xs">Artical number</th>
                        <th class="hidden-xs">Price</th>
                        <th>Total</th>
                      </thead>
                      <tbody>
                        <t t-foreach="order.order_line" t-as="line">
                          <tr>
                            <td>
                              <t t-esc="line.product_uom_qty" />
                            </td>
                            <td>
                              <t t-esc="line.product_id.name" />
                            </td>
                            <td class="hidden-xs">
                              <t t-esc="line.product_id.default_code" />
                            </td>
                            <td class="hidden-xs">
                              <t t-esc="line.price_unit" />
                              <t t-esc="order.currency_id.name" />
                            </td>
                            <td>
                              <t t-esc="line.price_subtotal" />
                              <t t-esc="order.currency_id.name" />
                            </td>
                             <td class="order_line_buttons"/>
                          </tr>
                        </t>
                      </tbody>
                    </table>
                  </div>
                  <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12">
                    <div class="pull-right col-md-4">
                      <p>
                        <label>Sum:</label>
                        <t t-esc="order.amount_untaxed" />
                        <t t-esc="order.currency_id.name" />
                      </p>
                      <p>
                        <label>Shipping:</label>
                        <t t-esc="order.carrier_id.normal_price" />
                        <t t-esc="order.currency_id.name" />
                      </p>
                      <p>
                        <label>Tax:</label>
                        <t t-esc="order.amount_tax" />
                        <t t-esc="order.currency_id.name" />
                      </p>
                      <hr />
                      <h4>
                        <label>Total:</label>
                        <t t-esc="order.amount_total" />
                        <t t-esc="order.currency_id.name" />
                      </h4>
                      <hr />
                    </div>
                    <div class="col-md-4">
                      <div>
                        <t t-esc="order.note"/>
                      </div>
                      <div>
                        <t t-foreach="order.picking_ids" t-as="picking">
                          <t t-esc="picking.note"/>
                        </t>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
          </section>
        </div>
      </t>
    </template>
    <template id="assets_frontend" inherit_id="website.assets_frontend" name="Website Sale Home Assets Frontend">
      <xpath expr="." position="inside">
        <link rel="stylesheet" href="/website_sale_home_order/static/src/css/main.css" t-ignore="true" />
        <script type="text/javascript" src="/website_sale_home_order/static/src/js/main.js" />
      </xpath>
    </template>
  </data>
</openerp>
